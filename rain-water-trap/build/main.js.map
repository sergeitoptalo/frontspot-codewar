{"version":3,"sources":["webpack:///webpack/bootstrap 25f889e02f59ae7653fe","webpack:///./src/index.js","webpack:///./src/wall.js","webpack:///./src/controls.js"],"names":["document","addEventListener","runButton","querySelector","container","controls","detectClickTarget","event","initialColumnsNumber","value","wall","getControlsContainer","removeEventListener","Wall","columnsNumber","state","row","addNewRow","render","wasRain","forEach","rowIndex","rowArray","firstStoneIndex","indexOf","lastStoneIndex","lastIndexOf","i","stoneIndex","splice","length","push","columnIndex","wallBorder","index","array","column","map","some","cell","cellIndex","cellsArray","rain","innerHTML","element","join","reverse","Controls","controlsContainer","target","dataset","action","addStone","parentNode","removeStone","controlsMarkup"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/assets/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 25f889e02f59ae7653fe","import Wall from './wall.js';\r\nimport Controls from './controls.js';\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    let runButton = document.querySelector('#run-button');\r\n\r\n    let container = document.querySelector('#container');\r\n    let controls;\r\n\r\n    let detectClickTarget = (event) => {\r\n        controls.detectClickTarget(event)\r\n    }\r\n\r\n    runButton.addEventListener('click', () => {\r\n        let initialColumnsNumber = document.querySelector('#columns-number').value;\r\n        let wall = new Wall(initialColumnsNumber, container);\r\n        if (controls) {\r\n            controls.getControlsContainer().removeEventListener('click', detectClickTarget);\r\n        }\r\n        controls = new Controls(wall, initialColumnsNumber);\r\n        controls.getControlsContainer().addEventListener('click', detectClickTarget);\r\n    });\r\n})\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/*   \r\nWall config: \r\n       -1 - water;\r\n        0 - space;\r\n        1 - stone;\r\n*/\r\n\r\nexport default class Wall {\r\n    constructor(columnsNumber, container) {\r\n        this.state = [];\r\n        this.row = [];\r\n        this.columnsNumber = columnsNumber;\r\n        this.container = container;\r\n        this.addNewRow();\r\n        this.render();\r\n    }\r\n\r\n    rain() {\r\n        this.state.wasRain = true;\r\n        this.state.forEach((row, rowIndex, rowArray) => {\r\n            let firstStoneIndex = row.indexOf(1);\r\n            let lastStoneIndex = row.lastIndexOf(1);\r\n\r\n            for (let i = firstStoneIndex; i < lastStoneIndex; i++) {\r\n                if (row[i] === 0) {\r\n                    row[i] = -1;\r\n                }\r\n            }\r\n        });\r\n\r\n        this.render();\r\n    }\r\n\r\n    addNewRow(stoneIndex) {\r\n        this.row.splice(0, this.row.length);\r\n        for (let i = 0; i < this.columnsNumber; i++) {\r\n            this.row.push(0);\r\n        }\r\n\r\n        if (stoneIndex) {\r\n            this.row[stoneIndex] = 1;\r\n        }\r\n\r\n        this.state.push([...this.row]);\r\n    }\r\n\r\n    addStone(columnIndex) {\r\n        let wallBorder = 0;\r\n\r\n        this.state.forEach((row, index, array) => {\r\n            if (row[columnIndex] === 1 && index === array.length - 1) {\r\n                this.addNewRow(columnIndex);\r\n            }\r\n            if (row[columnIndex] <= 0 && !wallBorder) {\r\n                row[columnIndex] = 1;\r\n                wallBorder = 1;\r\n            }\r\n        });\r\n\r\n        this.render();\r\n    }\r\n\r\n    removeStone(columnIndex) {\r\n        let column = this.state.map((row) => {\r\n            return row[columnIndex];\r\n        });\r\n\r\n        let lastStoneIndex = column.lastIndexOf(1);\r\n\r\n        if (lastStoneIndex !== -1) {\r\n            this.state[lastStoneIndex][columnIndex] = 0;\r\n\r\n            if (this.state[lastStoneIndex].some(cell => cell === -1)) {\r\n                this.state[lastStoneIndex].forEach((cell, cellIndex, cellsArray) => {\r\n                    if (cell === -1) {\r\n                        cellsArray[cellIndex] = 0;\r\n                    }\r\n                });\r\n\r\n                this.rain()\r\n            } else {\r\n                this.render()\r\n            };\r\n        }\r\n    }\r\n\r\n    render() {\r\n        container.innerHTML = `\r\n        <table>\r\n        ${this.state.map(row => {\r\n                return `<tr>\r\n                    ${\r\n                    row.map(element => {\r\n                        return `<td ${element !== 0 ? `class=\"${element === 1 ? `wall` : `water`}\"` : ``}></td>`;\r\n                    }).join('')\r\n                    }\r\n                </tr>`\r\n            }).reverse().join('')}\r\n        </table>\r\n      `\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/wall.js","export default class Controls {\r\n    constructor(wall, columnsNumber) {\r\n        this.wall = wall;\r\n        this.columnsNumber = columnsNumber;\r\n        this.controlsContainer = document.querySelector('#controls-container');\r\n\r\n        this.render();\r\n    }\r\n\r\n    getControlsContainer() {\r\n        return this.controlsContainer;\r\n    }\r\n\r\n    detectClickTarget(event) {\r\n        let target = event.target;\r\n        if (target.dataset) {\r\n            let action = target.dataset.action;\r\n            switch (action) {\r\n                case 'increase': {\r\n                    this.wall.addStone(target.parentNode.dataset.column);\r\n                    break;\r\n                };\r\n                case 'reduce': {\r\n                    this.wall.removeStone(target.parentNode.dataset.column);\r\n                    break;\r\n                };\r\n                case 'run-rain': {\r\n                    this.wall.rain();\r\n                    break;\r\n                }\r\n                default: break;\r\n            }\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let controlsMarkup = ``;\r\n        for (let i = 0; i < this.columnsNumber; i++) {\r\n            controlsMarkup += `\r\n        <td data-column=\"${i}\">\r\n            <button data-action=\"increase\">&#9650;</button>\r\n            <button data-action=\"reduce\">&#9660;</button>\r\n        </td>`\r\n        }\r\n\r\n        this.controlsContainer.innerHTML = `\r\n        <button data-action=\"run-rain\" class=\"rain-button\">Rain</button>\r\n        <table class=\"controls-table\">\r\n            <tr>\r\n                ${controlsMarkup}\r\n            </tr>\r\n        </table>\r\n        \r\n    `\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/controls.js"],"sourceRoot":""}